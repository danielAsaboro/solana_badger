# Standalone Exploit Demonstrations

This directory contains standalone exploit scripts that demonstrate each vulnerability in isolation. Each script:

- **Shows step-by-step attack narrative** with clear console output
- **Deploys vulnerable program** and executes the exploit
- **Demonstrates attacker gains** unauthorized access or funds
- **Compares with secure version** showing the attack is blocked
- **Can be run independently** without the main test suite

## ğŸš€ Quick Start

```bash
# Install dependencies (if not already done)
cd exploits/
npm install

# Run all exploits sequentially
./run-all-exploits.sh

# Or run individual exploits
npx ts-node 1-signer-checks-exploit.ts
npx ts-node 2-owner-checks-exploit.ts
npx ts-node 3-arbitrary-cpi-exploit.ts
npx ts-node 4-reinitialization-exploit.ts
npx ts-node 5-type-cosplay-exploit.ts
npx ts-node 6-pda-sharing-exploit.ts
```

## ğŸ“ Exploit Scripts

### 1. Missing Signer Checks (`1-signer-checks-exploit.ts`)
**Attack:** Steal ownership without victim's signature

**Scenario:**
1. Alice initializes her account
2. Attacker changes ownership WITHOUT Alice signing
3. On vulnerable version: Attack succeeds
4. On secure version: Attack blocked (MissingRequiredSignature)

**Impact:** Complete account takeover

---

### 2. Missing Owner Checks (`2-owner-checks-exploit.ts`)
**Attack:** Use fake account from malicious program

**Scenario:**
1. Attacker deploys malicious program
2. Attacker creates fake account with inflated balance
3. Attacker passes fake account to victim's program
4. On vulnerable version: Fake data accepted
5. On secure version: Fake account rejected (InvalidAccountOwner)

**Impact:** Protocol logic bypass, fund theft

---

### 3. Arbitrary CPI (`3-arbitrary-cpi-exploit.ts`)
**Attack:** Invoke malicious program with authority signature

**Scenario:**
1. Protocol has callback functionality
2. Attacker deploys malicious "token program"
3. Attacker calls callback with malicious program ID
4. On vulnerable version: Malicious program receives authority
5. On secure version: Unknown program rejected

**Impact:** Complete protocol compromise

---

### 4. Reinitialization Attacks (`4-reinitialization-exploit.ts`)
**Attack:** Reinitialize victim's account with attacker as owner

**Scenario:**
1. Alice initializes vault with her authority
2. Attacker derives Alice's vault PDA (public information)
3. Attacker calls initialize with attacker's authority
4. On vulnerable version: Reinitialization succeeds, authority overwritten
5. On secure version: Reinitialization blocked (AlreadyInitialized)

**Impact:** Account takeover, fund theft

---

### 5. Type Cosplay (`5-type-cosplay-exploit.ts`)
**Attack:** Pass User account as Admin account (type confusion)

**Real-world Impact:** $52M Cashio exploit used this vulnerability

**Scenario:**
1. Attacker creates User account (no special privileges)
2. Attacker passes User account to admin-only function
3. On vulnerable version: User account accepted as Admin (no discriminator check)
4. On secure version: Type mismatch detected (InvalidAccountData)

**Impact:** Privilege escalation, unauthorized actions

---

### 6. PDA Sharing (`6-pda-sharing-exploit.ts`)
**Attack:** Drain other users' deposits from shared pool

**Scenario:**
1. Program uses global PDA: `[b"pool"]` for all users
2. Alice deposits 100 SOL
3. Bob deposits 50 SOL
4. Alice withdraws 150 SOL (draining Bob's deposit)
5. On vulnerable version: Cross-user theft succeeds
6. On secure version: User-specific PDAs prevent theft

**Impact:** Cross-user fund theft

---

## ğŸ¯ Output Format

Each exploit script provides:

1. **Banner** with vulnerability name
2. **Setup phase** showing initial state
3. **Attack phase** with step-by-step narrative
4. **Vulnerable version result** showing exploit success
5. **Secure version result** showing attack blocked
6. **Summary** with vulnerability impact

Example output:

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  EXPLOIT: Missing Signer Checks
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Step 1: Alice initializes her account...
âœ… Alice's account initialized
   Owner: Alice123...

Step 2: ğŸš¨ ATTACK - Attacker steals ownership WITHOUT Alice signing
   Attacker passes Alice's pubkey but Alice does NOT sign!

VULNERABLE VERSION:
âš ï¸  EXPLOIT SUCCESSFUL!
   ğŸ’€ Transaction succeeded without Alice's signature
   ğŸ’€ Owner changed from Alice to Attacker
   ğŸ’€ Alice's account has been STOLEN!

SECURE VERSION:
âœ… ATTACK BLOCKED!
   âœ… Transaction rejected: MissingRequiredSignature
   âœ… Owner unchanged (still Alice)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## âš ï¸ Prerequisites

- **Solana CLI** installed and configured
- **Anchor** framework installed
- **Node.js** 18+ and npm/yarn
- **Local validator** running (optional, tests use ProgramTest)

## ğŸ“š Related Documentation

- [Main README](../README.md) - Project overview
- [Security Deep Dive](../SOLANA_SECURITY_DEEP_DIVE.md) - Complete vulnerability guide
- [Test Suite](../tests/) - Automated Anchor tests
- [Programs](../programs/) - Vulnerable and secure implementations

---

## ğŸ¤ Contributing

Found additional attack vectors? Want to add more exploits? Contributions welcome!

1. Create new exploit script following naming convention
2. Include both vulnerable and secure version demonstrations
3. Add clear console output with step-by-step narrative
4. Update this README with exploit description

---

**âš ï¸ Disclaimer:** These exploits are for educational purposes only. Use only on local test networks or your own programs. Do not use on mainnet or against programs you don't own.
